<!DOCTYPE html>
<html>
<head>
  <title>JavaScript</title>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/processing.js/1.4.8/processing.min.js"></script>
</head>
<body>
  <canvas id="canvas"></canvas>
  <script>
    var canvas = document.getElementById("canvas");
    var processing = new Processing(canvas, function(processing) {
        processing.size(400, 400);
        processing.background(0xFFF);

        var mouseIsPressed = false;
        processing.mousePressed = function () { mouseIsPressed = true; };
        processing.mouseReleased = function () { mouseIsPressed = false; };

        var keyIsPressed = false;
        processing.keyPressed = function () { keyIsPressed = true; };
        processing.keyReleased = function () { keyIsPressed = false; };

        function getImage(s) {
            var url = "https://www.kasandbox.org/programming-images/" + s + ".png";
            processing.externals.sketch.imageCache.add(url);
            return processing.loadImage(url);
        }

        // use degrees rather than radians in rotate function
        var rotateFn = processing.rotate;
        processing.rotate = function (angle) {
            rotateFn(processing.radians(angle));
        };

        with (processing) {


            // INSERT YOUR KHAN ACADEMY PROGRAM HERE
            var keys = [];
            keyPressed = function() {
                keys[keyCode] = true;
            };
            keyReleased = function(){
                keys[keyCode] = false;
            };

            //constructor function creates player object
            var Player = function(x,y,size, speed){
              this.x=x;
              this.y=y;
              this.size=size;
              this.speed=speed;

              //kind of like method
              this.update = function(){
                noStroke();
                fill(255, 0, 0);
                ellipse(this.x, this.y, size, size);
                if (keyIsPressed && keys[UP]){
                    this.y = this.y - this.speed;
                }
                if (keyIsPressed && keys[DOWN]){
                    this.y = this.y + this.speed;
                }
                if (keyIsPressed && keys[RIGHT]){
                    this.x = this.x + this.speed;
                }
                if (keyIsPressed && keys[LEFT]){
                    this.x = this.x - this.speed;
                }
              };
            };
            //constructor function creates dot object
            var Dot = function(x, y, size, speed){
                this.x = x;
                this.y = y;
                this.xVel = random(-speed, speed);
                this.yVel = random(-speed, speed);
                this.size = size;
                this.speed = speed;
                this.update = function(){
                    //make the dots move
                    this.x = this.x + this.xVel;
                    if (this.x < 10 || this.x> 390){
                        this.xVel = -this.xVel;
                    }

                    if (this.y < 10 || this.y > 390){
                        this.yVel = -this.yVel;
                    }
                    this.y = this.y + this.yVel;
                    //draw the dot
                    fill(114, 148, 201);
                    ellipse(this.x, this.y, this. size, this.size);
                };
            };

            //instance of player
            var player = new Player(100,100,30,1);

            //instance of dot in array
            var allTheDots = [];
            for (var i = 0; i<10; i++){
                allTheDots.push (new Dot ( random(10,390),//x
                                    random(10,390),//y
                                    20,
                                    random(1,2))
                                );

            }

            //check for collision function
            var checkForCollisions = function(){
                //loop through entire dots array
                for(var i=0; i<allTheDots.length; i++){
                    //calculates the distance between the center of player dot & each array dot
                    var distance = dist(player.x, player.y,allTheDots[i].x, allTheDots[i].y);
                    //if distance is less than combined radius of player & dot, COLLISION!!
                    if(distance <= (player.size/2 + allTheDots[i].size/2)){
                        //Splice removes items from array   array.splice(item, how many);
                        allTheDots.splice(i,1);
                    }
                }
            };



            var draw = function() {
                background(0, 0, 0);
                player.update();
                for(var i in allTheDots){
                    allTheDots[i].update();
                }
               checkForCollisions(player,allTheDots);
            };

        }
        if (typeof draw !== 'undefined') processing.draw = draw;
    });
  </script>
</body>
</html>
